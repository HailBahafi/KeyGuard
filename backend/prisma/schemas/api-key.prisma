enum ApiKeyStatus {
  ACTIVE
  IDLE
  EXPIRED
  REVOKED
}

enum ApiKeyProvider {
  OPENAI
  ANTHROPIC
  GOOGLE
  AZURE
}

enum ApiKeyEnvironment {
  PRODUCTION
  DEVELOPMENT
  STAGING
}

model ApiKey {
  id          String            @id @default(uuid())
  name        String
  provider    ApiKeyProvider
  status      ApiKeyStatus      @default(ACTIVE)
  environment ApiKeyEnvironment
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  lastUsed    DateTime?
  expiresAt   DateTime?
  description String?
  maskedValue String // e.g., "sk-...abc123"
  fullValue   String // Encrypted full key value
  apiKey      String // API key value
  usageCount  Int               @default(0)

  // Organization relation
  organizationId String?
  organization   Organization? @relation(fields: [organizationId], references: [id], onDelete: SetNull)

  // Relations
  devices   Device[]
  auditLogs AuditLog[]

  @@map("api_keys")
}
