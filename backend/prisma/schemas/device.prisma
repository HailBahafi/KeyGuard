enum DeviceStatus {
  ACTIVE
  INACTIVE
  REVOKED
  SUSPENDED
}

model Device {
  id                  String       @id @default(uuid())
  keyId               String
  publicKeySpkiBase64 String
  fingerprint         String
  label               String
  userAgent           String?
  metadata            Json?
  status              DeviceStatus @default(ACTIVE)
  apiKeyId            String
  lastSeenAt          DateTime     @default(now())
  createdAt           DateTime     @default(now())
  updatedAt           DateTime     @updatedAt
  apiKey              ApiKey       @relation(fields: [apiKeyId], references: [id], onDelete: Cascade)

  @@unique([apiKeyId, keyId])
  @@map("devices")
}
